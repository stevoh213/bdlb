# Refactor Tasks

This file outlines the tasks for refactoring the codebase.

## Task 1: Improve code readability

- [ ] Add comments to complex functions.
- [ ] Ensure consistent naming conventions.
- [ ] Break down long functions into smaller, manageable ones.

## Task 2: Enhance performance

- [ ] Identify and optimize performance bottlenecks.
- [ ] Implement caching mechanisms where appropriate.

## Task 3: Update documentation

- [ ] Review and update existing documentation.
- [ ] Add documentation for new features.
- [ ] Ensure all code examples are accurate and up-to-date.

## Task 4: Increase test coverage

- [ ] Write unit tests for all new functions.
- [ ] Improve existing tests to cover more edge cases.
- [ ] Aim for a minimum of 90% test coverage.

## Task 5: Specific Refactoring Tasks

### Form Logic
- [ ] **Refactor Form Logic in `ClimbLogForm.tsx` and `SessionForm.tsx`**: Extract form state management and submission logic into custom hooks (e.g., `useClimbForm`, `useSessionForm`) to improve component readability and reusability.
- [ ] **Refactor Form Logic in `src/components/VisualLoginForm.tsx`**:
    - *Reasoning*: This component is over 200 lines and contains logic for both sign-in and sign-up forms.
    - *Suggestion*: Extracting form state management (email, password, loading states) and submission handlers (`handleSignIn`, `handleSignUp`) into a custom hook (e.g., `useAuthForm`) would improve readability, separation of concerns, and make the component easier to maintain.

### Data Fetching & State Management
- [ ] **Create a Service Layer for Data Fetching**: Abstract Supabase queries and mutations from `useClimbingSessions.ts` and `useClimbs.ts` into a dedicated service layer (e.g., `services/climbingService.ts`). This will improve separation of concerns, testability, and maintainability.

### Styling
- [ ] **Refactor Styling in `ClimbLogForm.tsx`**: Move the `tickTypeColors` object and conditional styling for tick type badges to a CSS module or a utility function to separate styling concerns from component logic.

### Large Component Breakdown
- [ ] **Break Down Large Page Components (`src/pages/History.tsx` and `src/pages/Settings.tsx`)**:
    - **`src/pages/History.tsx` (479 lines)**:
        - *Reasoning*: This component manages a significant amount of state and logic related to displaying and interacting with climbing sessions.
        - *Suggestions*:
            - Move session data management (fetching, CRUD operations on sessions and climbs) into a custom hook (e.g., `useSessionHistory`) or a dedicated state management solution.
            - Extract UI sections like the selected session details view and the list of sessions into smaller, dedicated components.
            - Move utility functions like `formatDate`, `formatTime` to a shared utility file if not already present.
    - **`src/pages/Settings.tsx` (462 lines)**:
        - *Reasoning*: This component handles various distinct settings sections, leading to a large file with mixed responsibilities.
        - *Suggestions*:
            - For each settings category (Grade System, Saved Locations, Physical Skills, Technical Skills), extract its state management and related logic (including `localStorage` interactions) into dedicated custom hooks (e.g., `useGradeSettings`, `useLocationSettings`).
            - Create separate components for each settings section/card.
            - Consider a generic `ManageListItems` component for handling editable lists (like locations and skills) to reduce code duplication.
            - Abstract `localStorage` interactions into a generic `useLocalStorage` hook or a settings service.

- [ ] **Consider Breaking Down Very Large UI Components (e.g., `src/components/ui/sidebar.tsx`)**:
    - **`src/components/ui/sidebar.tsx` (695 lines)**:
        - *Reasoning*: While likely a library component or a well-structured custom component, its sheer size warrants a note.
        - *Suggestion*: If this is a custom component, evaluate if its internal sub-components (like `SidebarProvider`, `SidebarContent`, etc.) can be further simplified or if any part of its logic is overly complex and could be broken down. If it's a third-party library component, this is more of an FYI unless specific usability issues arise from its complexity.

### Notes on Generated Files
- **Note on Generated Files (`src/integrations/supabase/types.ts`)**:
    - **`src/integrations/supabase/types.ts` (495 lines)**:
        - *Reasoning*: This file is auto-generated by Supabase.
        - *Suggestion*: Do not manually refactor. Its length is a consequence of the database schema size.
